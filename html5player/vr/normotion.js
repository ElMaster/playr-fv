var Normotion=function(){var l=Date.now();var m=quat.create();var b=quat.create();var i=true;var j=0.2;var a=false;var e=(window.screen&&window.screen.orientation&&window.screen.orientation.angle!==undefined&&window.screen.orientation.angle!==null);function c(){if(e){return window.screen.orientation.angle}else{return window.orientation}}function d(s,p){var f=p*s.alpha*0.5;var B=p*s.beta*0.5;var r=p*s.gamma*0.5;var G=B;var F=c();if(F===90){B=f;f=-G}else{if(F===180){B=-B;f=-f}else{if(F===270){B=-f;f=G}}}var q=Math.cos(f);var o=Math.cos(B);var n=Math.cos(r);var D=Math.sin(f);var A=Math.sin(B);var u=Math.sin(r);var E=q*o*n-D*A*u;var C=D*o*n-q*A*u;var v=q*A*n+D*o*u;var t=D*A*n+q*o*u;return quat.fromValues(C,v,t,E)}function h(f,n){quat.multiply(m,m,f);quat.slerp(m,m,b,j*n)}function k(r){var H=Math.PI/180;var G=H*r.beta*0.5;var n=H*r.gamma*0.5;var A=H*r.alpha*0.5;var p=Math.cos(G);var o=Math.cos(n);var f=Math.cos(A);var D=Math.sin(G);var C=Math.sin(n);var B=Math.sin(A);var v=p*o*f-D*C*B;var u=D*o*f-p*C*B;var t=p*C*f+D*o*B;var s=D*C*f+p*o*B;var E=quat.fromValues(u,t,s,v);var F=Math.sqrt(0.5);quat.multiply(E,quat.fromValues(-F,0,0,F),E);var q=c();if(q===90){quat.rotateZ(E,E,Math.PI*-0.5)}else{if(q===180){quat.rotateZ(E,E,Math.PI)}else{if(q===270){quat.rotateZ(E,E,Math.PI*0.5)}}}return E}function g(f){b=f}this.onDeviceMotion=function(o){if(o.rotationRate.alpha||o.rotationRate.beta||o.rotationRate.gamma){a=true}else{return}var n=Date.now()-l;var p=n*0.001;var f=d(o.rotationRate,p);h(f,p);l+=n};this.onDeviceOrientation=function(n){if(n.alpha||n.beta||n.gamma){a=true}else{return}var f=k(n);g(f);if(i){m=b;i=false}};this.getViewQuat=function(){return m};this.forceReorient=function(){i=true};this.hasSensorInput=function(){return a}};