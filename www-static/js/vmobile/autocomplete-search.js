var autocompleteSearch=(function(){var m;function e(){var o={minLength:2,showDelay:400,showPornstars:true,defaultType:"video",boldenResults:true,formId:"searchForm",inputId:"search_text",categoryElementId:"searchCategory",filterTypeId:"searchFilterType",openBtnId:"openSearch",closeBtnId:"closeSearch",searchSectionId:"searchSection",suggestionsList:"div.suggestions"};this.options=MG_Utils.extendDefaults(o,arguments[0]);this.form=document.getElementById(this.options.formId);this.input=document.getElementById(this.options.inputId);this.category=document.getElementById(this.options.categoryElementId);this.filterType=document.getElementById(this.options.filterTypeId);this.openBtn=document.getElementById(this.options.openBtnId);this.closeBtn=document.getElementById(this.options.closeBtnId);this.searchSection=document.getElementById(this.options.searchSectionId);this.suggestionsList=document.querySelector(this.options.suggestionsList);this.currentType=null;this.logo=document.getElementById("phubLogo")||document.getElementById("premiumLogo");this.mobileHeader=document.getElementById("mobileHeader");this.mobileContainer=document.getElementById("mobileContainer");this.types={video:"video",albums:"photo",pornstars:"pornstars",gifs:"gifs",user:"user"};if(!m){l.call(this)}return m}e.prototype={constructor:e,setType:function(){var p=window.location.pathname,q=p.split("/")[1];this.currentType=this.types[this.options.defaultType];if(q){if(q=="gay"||q=="shemale"){var o=p.split("/")[2];if(o=="gifs"){this.currentType="gifs"}else{if(o=="pornstars"){this.currentType="pornstars"}}}else{if(this.types[q]){if(p.split("/")[2]!="edit"){this.currentType=this.types[q]}}}}b.call(this)},changeType:function(){$$.timeouts.autocomplete.value="";this.suggestionsList.style.display="none";MG_Utils.triggerEvent(this.input,"keyup")},setPreviousSearches:function(){if($$.cache.local.search){if(document.querySelector(".js-search")){if(document.querySelector(".js-search").getAttribute("data-search")){this.input.value=$$.cache.local.search}}else{this.input.value=""}}},close:function(o){this.suggestionsList.innerHTML="";this.suggestionsList.style.display="none";if(this.input.value){this.input.value="";this.input.focus()}else{MG_Utils.toggle(this.logo);MG_Utils.toggleClass(this.closeBtn,"active");this.filterType.style.display="none";MG_Utils.removeClass(this.mobileHeader,"active");if(MG_Utils.hasClass(document.body,"cssTranstions")){MG_Utils.removeClass(this.searchSection,"active")}}if(o&&typeof o=="function"){o(this)}},open:function(o){MG_Utils.toggleClass(this.openBtn,"active");this.input.focus();this.input.value=this.input.getAttribute("value");setTimeout(function(){window.scrollTo(0,1)},100);if(MG_Utils.hasClass(document.body,"cssTranstions")){MG_Utils.addClass(this.searchSection,"active")}MG_Utils.toggle(this.logo);if(o&&typeof o=="function"){o(this)}}};function l(){this.setType();this.setPreviousSearches();a.call(this);m=this}function a(){var o=this;MG_Utils.addEventHandler(this.form,"submit",function(p){c.call(o,p)});g.call(this);[].forEach.call(this.filterType.querySelectorAll(".filterBtnType"),function(p){MG_Utils.addEventHandler(p,"click",function(q){k.call(o,this)})});MG_Utils.addEventHandler(this.category,"click",function(p){MG_Utils.toggle(o.filterType)});MG_Utils.addEventHandler(this.openBtn,"click",function(p){o.open()});MG_Utils.addEventHandler(this.closeBtn,"click",function(p){o.close()})}function g(){var o=this;MG_Utils.addEventHandler(this.input,"keyup",function(p){i.call(o,p)});MG_Utils.addEventHandler(this.input,"focus",function(p){n.call(o)});MG_Utils.addEventHandler(this.input,"click",function(p){n.call(o)});MG_Utils.addEventHandler(this.input,"input",function(p){if(this.value==""){localStorage.removeItem("search");localStorage.removeItem("searches")}})}function k(o){this.currentType=o.getAttribute("data-search-type");b.call(this);this.filterType.style.display="none";this.changeType()}function b(){this.category.setAttribute("data-search-category",this.currentType);MG_Utils.removeMultipleClass(this.category,["video","photo","user","pornstars","gifs"]);MG_Utils.addClass(this.category,this.currentType);MG_Utils.removeClassMultiple(this.filterType.querySelectorAll(".filterBtnType"),"active");var o=this.filterType.querySelector('.filterBtnType[data-search-type="'+this.currentType+'"]');MG_Utils.addClass(o,"active")}function c(t){var p=this.input.value,o=encodeURIComponent(this.input.value.replace(/[\<\>]+/gi,"")),v=o.replace(/%20/g,"+").toLowerCase(),s=v.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),u;if(p!=""&&p!="Pornhub Search"){if(this.currentType=="video"){if(typeof $$.cache.local.searches!="undefined"){if(!$$.cache.local.searches.match(s)){var r=$$.cache.local.searches.split("&");if(r.length>=10){r.splice(0,r.length-9)}$$.cache.local.searches=r.concat([o]).join("&").replace(/(^&|&$)/gi,"").replace(/&{2,}/gi,"&")}}else{try{$$.cache.local.searches=o}catch(q){}}}try{$$.cache.local.search=this.input.value}catch(q){}u=d.call(this);if(u){if(this.input.value=="gay"&&this.currentType!="user"){document.location.href="/"+u.string}else{document.location.href="/"+u.string+u.connective+u.query+"="+v}}}t.preventDefault?t.preventDefault():(t.returnValue=false)}function i(t){var s=t.target,o=t.keyCode?t.keyCode:t.charCode,q=s.value.replace(/^\s+|\s+$/g,""),p=this;switch(o){case 13:return false;break;case 60:case 62:return false;break;default:if(s.value.match(/[\<\>]+/gi)){s.value=s.value.replace(/[\<\>]+/gi,"")}}var r=(this.currentType=="photo"||this.currentType=="gifs")?"video":this.currentType;if(q.length<this.options.minLength){$$.timeouts.autocomplete.value="";clearTimeout($$.timeouts.autocomplete.timer);$$.timeouts.autocomplete.matches=0;this.suggestionsList.style.display="none"}else{if(q!=$$.timeouts.autocomplete.value){$$.timeouts.autocomplete.value=q;clearTimeout($$.timeouts.autocomplete.timer);if(r!="user"){$$.timeouts.autocomplete.timer=setTimeout(function(){MG_Utils.ajaxGet({url:"/"+r+"/search_autocomplete?"+s.getAttribute("data-autocomplete")+"&q="+encodeURIComponent(q)+"&alt=0"+(p.options.showPornstars?"&pornstars=true":""),success:function(u){h.call(p,u)}})},this.options.showDelay)}}}MG_Utils.addClass(this.mobileHeader,"active")}function h(r){var p=this;if($$.timeouts.autocomplete.matches==0){this.suggestionsList.style.display="none"}this.suggestionsList.innerHTML="";var q=false,o=$$.methods.safeJSON(r);q=f.call(this,o);if(!q){$$.timeouts.autocomplete.matches=0;this.suggestionsList.style.display="none";MG_Utils.appendString(this.suggestionsList,'<p class="nomatches">No matches.</p>')}if(MG_Utils.hasClass(this.searchSection,"active")){this.suggestionsList.style.display="block"}MG_Utils.addEventHandler(this.mobileContainer,"click",function(){p.suggestionsList.style.display="none"});MG_Utils.addEventHandler(document.querySelector(".bottomNav"),"click",function(){p.suggestionsList.style.display="none"});MG_Utils.addEventHandler(this.input,"click",function(){p.suggestionsList.style.display="block"})}function n(){if(isAndroid){MG_Utils.addEventHandler(window,"scroll",function(o){if(this.input.value!==""){this.input.blur()}})}this.filterType.style.display="none";MG_Utils.addClass(this.logo,"active")}function d(){var o={};switch(this.currentType){case"video":o.string=(this.input.value=="gay")?"gayporn":($$.globals.isGay)?"gay/video/search":"video/search";o.query="search";o.connective="?";break;case"photo":o.string=(this.input.value=="gay")?"albums/gay":($$.globals.isGay)?"albums/gay":"albums/female-straight-uncategorized";o.query="search";o.connective="?";break;case"user":o.string="user/search?gender=0";o.query="username";o.connective="&";break;case"pornstars":o.string=(this.input.value=="gay")?"gay/pornstars":($$.globals.isGay)?"gay/pornstars/search":"pornstars/search";o.query="search";o.connective="?";break;case"gifs":o.string=(this.input.value=="gay")?"gay/gifs":($$.globals.isGay)?"gay/gifs/search":"gifs/search";o.query="search";o.connective="?";break}return o}function f(o){var r=false,q=this;if(o instanceof Array&&o.length){$$.timeouts.autocomplete.matches=o.length;MG_Utils.appendString(this.suggestionsList,'<p class="label">Suggestions</p>');for(var p in o){MG_Utils.appendString(this.suggestionsList,'<button class="suggestion query">'+(this.options.boldenResults==true?j.call(this,o[p]):o[p])+"</button>")}[].forEach.call(this.suggestionsList.querySelectorAll(".query"),function(s){MG_Utils.addEventHandler(s,"click",function(){q.input.value=this.textContent||this.innerText;c.call(q)})});r=true}else{if(o.queries instanceof Array&&o.queries.length){$$.timeouts.autocomplete.matches=o.queries.length;MG_Utils.appendString(this.suggestionsList,'<p class="label">'+this.currentType.capitalize()+" results</p>");for(var p in o.queries){MG_Utils.appendString(this.suggestionsList,'<button class="suggestion query">'+(this.options.boldenResults==true?j.call(this,o.queries[p]):o.queries[p])+"</button>")}[].forEach.call(this.suggestionsList.querySelectorAll(".query"),function(s){MG_Utils.addEventHandler(s,"click",function(){q.input.value=this.textContent||this.innerText;c.call(q)})});r=true}if(o.pornstars instanceof Array&&o.pornstars.length){MG_Utils.appendString(this.suggestionsList,'<p class="label">Pornstar profiles</p>');for(var p in o.pornstars){MG_Utils.appendString(this.suggestionsList,'<button class="suggestion pornstar" data-slug="'+o.pornstars[p]["slug"]+'">'+(this.options.boldenResults==true?j.call(this,o.pornstars[p]["name"]):o.pornstars[p]["name"])+'&nbsp;&nbsp;-&nbsp;&nbsp;<span class="rank">Rank: '+o.pornstars[p]["rank"]+"</span></button>")}[].forEach.call(this.suggestionsList.querySelectorAll(".pornstar"),function(s){MG_Utils.addEventHandler(s,"click",function(){location.href="/pornstar/"+this.getAttribute("data-slug")})});r=true}if(o.channels instanceof Array&&o.channels.length){MG_Utils.appendString(this.suggestionsList,'<p class="label">Channels</p>');for(var p in o.channels){MG_Utils.appendString(this.suggestionsList,'<button class="suggestion channel" data-slug="'+o.channels[p]["slug"]+'">'+(this.options.boldenResults==true?j.call(this,o.channels[p]["name"]):o.channels[p]["name"])+'&nbsp;&nbsp;-&nbsp;&nbsp;<span class="rank">Rank: '+o.channels[p]["rank"]+"</span></button>")}[].forEach.call(this.suggestionsList.querySelectorAll(".channel"),function(s){MG_Utils.addEventHandler(s,"click",function(){location.href="/channels/"+this.getAttribute("data-slug")})});r=true}}return r}function j(p){var s=this.input.value,r=p.search(RegExp(""+s,"i"));if(r>=0){s=s.toLowerCase();var o=p.split(/\s|_/);for(var q=0;q<o.length;q++){o[q]=o[q].substr(0,1).toUpperCase()+(o[q].length>1?o[q].substr(1,o[q].length).toLowerCase():"")}p=o.join(" ");p=p.slice(0,r)+'<span class="soughtValue">'+s+"</span>"+p.slice(r+s.length)}return p}return e}());