!function(N){var V=function(){return N.requestAnimationFrame||N.webkitRequestAnimationFrame||N.mozRequestAnimationFrame||function(a){N.setTimeout(a,1000/60)}}(),ah=function(a){this.bytes=new Uint8Array(a),this.length=this.bytes.length,this.writePos=this.bytes.length,this.index=0};ah.NOT_FOUND=-1,ah.prototype.findNextMPEGStartCode=function(){for(var a=this.index+7>>3;a<this.writePos;a++){if(0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2]){return this.index=a+4<<3,this.bytes[a+3]}}return this.index=this.writePos<<3,ah.NOT_FOUND},ah.prototype.nextBytesAreStartCode=function(){var a=this.index+7>>3;return a>=this.writePos||0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2]},ah.prototype.nextBits=function(b){var d=this.index>>3,f=8-this.index%8;if(f>=b){return this.bytes[d]>>f-b&255>>8-b}var a=(this.index+b)%8,g=this.index+b-1>>3,c=this.bytes[d]&255>>8-f;for(d++;g>d;d++){c<<=8,c|=this.bytes[d]}return a>0?(c<<=a,c|=this.bytes[d]>>8-a):(c<<=8,c|=this.bytes[d]),c},ah.prototype.getBits=function(a){var b=this.nextBits(a);return this.index+=a,b},ah.prototype.advance=function(a){return this.index+=a},ah.prototype.rewind=function(a){return this.index-=a};var ad=N.JVmpeg=function(a,b){b=b||{},this.benchmark=!!b.benchmark,this.canvas=b.canvas||document.createElement("canvas"),this.autoplay=!!b.autoplay,this.loop=!!b.loop,this.externalLoadCallback=b.onload||null,this.externalDecodeCallback=b.ondecodeframe||null,this.externalFinishedCallback=b.onfinished||null,this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.zeroBlockData=new Int32Array(64),this.fillArray(this.zeroBlockData,0),!b.forceCanvas2D&&this.initWebGL()?this.renderFrame=this.renderFrameGL:(this.canvasContext=this.canvas.getContext("2d"),this.renderFrame=this.renderFrame2D),a instanceof WebSocket?(this.client=a,this.client.onopen=this.initSocketClient.bind(this)):this.load(a)};ad.prototype.isRecording=!1,ad.prototype.recorderWaitForIntraFrame=!1,ad.prototype.recordedFrames=0,ad.prototype.recordedSize=0,ad.prototype.didStartRecordingCallback=null,ad.prototype.recordBuffers=[],ad.prototype.canRecord=function(){return this.client&&this.client.readyState==this.client.OPEN},ad.prototype.startRecording=function(b){if(this.canRecord()){this.discardRecordBuffers(),this.isRecording=!0,this.recorderWaitForIntraFrame=!0,this.didStartRecordingCallback=b||null,this.recordedFrames=0,this.recordedSize=0;var c=this.width>>4,d=(15&this.width)<<4|this.height>>8,a=255&this.height;this.recordBuffers.push(new Uint8Array([0,0,1,179,c,d,a,50,255,255,225,88,0,0,1,184,0,8,0,15,15,0,1,0]))}},ad.prototype.recordFrameFromCurrentBuffer=function(){if(this.isRecording){if(this.recorderWaitForIntraFrame){if(this.pictureCodingType!=U){return}this.recorderWaitForIntraFrame=!1,this.didStartRecordingCallback&&this.didStartRecordingCallback(this)}this.recordedFrames++,this.recordedSize+=this.buffer.writePos,this.recordBuffers.push(new Uint8Array(this.buffer.bytes.subarray(0,this.buffer.writePos)))}},ad.prototype.discardRecordBuffers=function(){this.recordBuffers=[],this.recordedFrames=0},ad.prototype.stopRecording=function(){var a=new Blob(this.recordBuffers,{type:"video/mpeg"});return this.discardRecordBuffers(),this.isRecording=!1,a},ad.prototype.load=function(a){this.url=a;var b=new XMLHttpRequest,c=this;b.onreadystatechange=function(){b.readyState==b.DONE&&200==b.status&&c.loadCallback(b.response)},b.onprogress=this.gl?this.updateLoaderGL.bind(this):this.updateLoader2D.bind(this),b.open("GET",a),b.responseType="arraybuffer",b.send()},ad.prototype.updateLoader2D=function(b){var c=b.loaded/b.total,d=this.canvas.width,a=this.canvas.height,f=this.canvasContext;f.fillStyle="#FF0000",f.fillRect(0,0,d,a),f.fillStyle="#FF0000",f.fillRect(0,a-a*c,d,a*c)},ad.prototype.updateLoaderGL=function(a){var b=this.gl;b.uniform1f(b.getUniformLocation(this.loadingProgram,"loaded"),a.loaded/a.total),b.drawArrays(b.TRIANGLE_STRIP,0,4)},ad.prototype.loadCallback=function(a){this.buffer=new ah(a),this.findStartCode(J),this.firstSequenceHeader=this.buffer.index,this.decodeSequenceHeader(),this.nextFrame(),this.autoplay&&this.play(),this.externalLoadCallback&&this.externalLoadCallback(this)},ad.prototype.play=function(){this.playing||(this.targetTime=this.now(),this.playing=!0,this.scheduleNextFrame())},ad.prototype.pause=function(){this.playing=!1},ad.prototype.stop=function(){this.buffer&&(this.buffer.index=this.firstSequenceHeader),this.playing=!1,this.client&&(this.client.close(),this.client=null)},ad.prototype.readCode=function(a){var b=0;do{b=a[b+this.buffer.getBits(1)]}while(b>=0&&0!=a[b]);return a[b+2]},ad.prototype.findStartCode=function(a){for(var b=0;;){if(b=this.buffer.findNextMPEGStartCode(),b==a||b==ah.NOT_FOUND){return b}}return ah.NOT_FOUND},ad.prototype.fillArray=function(b,c){for(var d=0,a=b.length;a>d;d++){b[d]=c}},ad.prototype.cachedFrameCount=0,ad.prototype.calculateFrameCount=function(){if(!this.buffer||this.cachedFrameCount){return this.cachedFrameCount}var a=this.buffer.index,b=0;for(this.buffer.index=0;this.findStartCode(W)!==ah.NOT_FOUND;){b++}return this.buffer.index=a,this.cachedFrameCount=b,b},ad.prototype.calculateDuration=function(){return this.calculateFrameCount()*(1/this.pictureRate)},ad.prototype.pictureRate=30,ad.prototype.lateTime=0,ad.prototype.firstSequenceHeader=0,ad.prototype.targetTime=0,ad.prototype.benchmark=!1,ad.prototype.benchFrame=0,ad.prototype.benchDecodeTimes=0,ad.prototype.benchAvgFrameTime=0,ad.prototype.now=function(){return N.performance?N.performance.now():Date.now()},ad.prototype.nextFrame=function(){if(this.buffer){for(var a=this.now();;){var b=this.buffer.findNextMPEGStartCode();if(b==J){this.decodeSequenceHeader()}else{if(b==W){return this.playing&&this.scheduleNextFrame(),this.decodePicture(),this.benchDecodeTimes+=this.now()-a,this.canvas}if(b==ah.NOT_FOUND){return this.stop(),this.externalFinishedCallback&&this.externalFinishedCallback(this),this.loop&&this.sequenceStarted&&this.play(),null}}}}},ad.prototype.scheduleNextFrame=function(){this.lateTime=this.now()-this.targetTime;var a=Math.max(0,1000/this.pictureRate-this.lateTime);this.targetTime=this.now()+a,this.benchmark?(this.benchFrame++,this.benchFrame>=120&&(this.benchAvgFrameTime=this.benchDecodeTimes/this.benchFrame,this.benchFrame=0,this.benchDecodeTimes=0,N.console&&console.log("Average time per frame:",this.benchAvgFrameTime,"ms")),setTimeout(this.nextFrame.bind(this),0)):18>a?this.scheduleAnimation():setTimeout(this.scheduleAnimation.bind(this),a)},ad.prototype.scheduleAnimation=function(){V(this.nextFrame.bind(this),this.canvas)},ad.prototype.decodeSequenceHeader=function(){if(this.width=this.buffer.getBits(12),this.height=this.buffer.getBits(12),this.buffer.advance(4),this.pictureRate=Q[this.buffer.getBits(4)],this.buffer.advance(30),this.initBuffers(),this.buffer.getBits(1)){for(var a=0;64>a;a++){this.customIntraQuantMatrix[al[a]]=this.buffer.getBits(8)}this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.buffer.getBits(1)){for(var a=0;64>a;a++){this.customNonIntraQuantMatrix[al[a]]=this.buffer.getBits(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}},ad.prototype.initBuffers=function(){if(this.intraQuantMatrix=ae,this.nonIntraQuantMatrix=Z,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.quarterSize=this.codedSize>>2,!this.sequenceStarted){this.sequenceStarted=!0;var a=N.Uint8ClampedArray||N.Uint8Array;N.Uint8ClampedArray||(this.copyBlockToDestination=this.copyBlockToDestinationClamp,this.addBlockToDestination=this.addBlockToDestinationClamp),this.currentY=new a(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new a(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new a(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new a(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new a(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new a(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer),this.canvas.width=this.width,this.canvas.height=this.height,this.gl?(this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)):(this.currentRGBA=this.canvasContext.getImageData(0,0,this.width,this.height),this.fillArray(this.currentRGBA.data,255))}},ad.prototype.currentY=null,ad.prototype.currentCr=null,ad.prototype.currentCb=null,ad.prototype.currentRGBA=null,ad.prototype.pictureCodingType=0,ad.prototype.forwardY=null,ad.prototype.forwardCr=null,ad.prototype.forwardCb=null,ad.prototype.fullPelForward=!1,ad.prototype.forwardFCode=0,ad.prototype.forwardRSize=0,ad.prototype.forwardF=0,ad.prototype.decodePicture=function(d){if(this.buffer.advance(10),this.pictureCodingType=this.buffer.getBits(3),this.buffer.advance(16),!(this.pictureCodingType<=0||this.pictureCodingType>=j)){if(this.pictureCodingType==af){if(this.fullPelForward=this.buffer.getBits(1),this.forwardFCode=this.buffer.getBits(3),0==this.forwardFCode){return}this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}var k=0;do{k=this.buffer.findNextMPEGStartCode()}while(k==z||k==O);for(;k>=K&&H>=k;){this.decodeSlice(255&k),k=this.buffer.findNextMPEGStartCode()}if(this.buffer.rewind(32),this.recordFrameFromCurrentBuffer(),d!=Y&&(this.renderFrame(),this.externalDecodeCallback&&this.externalDecodeCallback(this,this.canvas)),this.pictureCodingType==U||this.pictureCodingType==af){var l=this.forwardY,c=this.forwardY32,g=this.forwardCr,b=this.forwardCr32,f=this.forwardCb,m=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=l,this.currentY32=c,this.currentCr=g,this.currentCr32=b,this.currentCb=f,this.currentCb32=m}}},ad.prototype.YCbCrToRGBA=function(){for(var am,ap,aA,aw,ar,an=this.currentY,aE=this.currentCb,ax=this.currentCr,at=this.currentRGBA.data,aC=0,aB=this.codedWidth,az=this.codedWidth+(this.codedWidth-this.width),S=0,av=this.halfWidth-(this.width>>1),aq=0,au=4*this.width,aD=4*this.width,A=this.width>>1,E=this.height>>1,ao=0;E>ao;ao++){for(var ay=0;A>ay;ay++){am=aE[S],ap=ax[S],S++,aA=ap+(103*ap>>8)-179,aw=(88*am>>8)-44+(183*ap>>8)-91,ar=am+(198*am>>8)-227;var k=an[aC++],P=an[aC++];at[aq]=k+aA,at[aq+1]=k-aw,at[aq+2]=k+ar,at[aq+4]=P+aA,at[aq+5]=P-aw,at[aq+6]=P+ar,aq+=8;var R=an[aB++],D=an[aB++];at[au]=R+aA,at[au+1]=R-aw,at[au+2]=R+ar,at[au+4]=D+aA,at[au+5]=D-aw,at[au+6]=D+ar,au+=8}aC+=az,aB+=az,aq+=aD,au+=aD,S+=av}},ad.prototype.renderFrame2D=function(){this.YCbCrToRGBA(),this.canvasContext.putImageData(this.currentRGBA,0,0)},ad.prototype.gl=null,ad.prototype.program=null,ad.prototype.YTexture=null,ad.prototype.CBTexture=null,ad.prototype.CRTexture=null,ad.prototype.createTexture=function(b,c){var d=this.gl,a=d.createTexture();return d.bindTexture(d.TEXTURE_2D,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.uniform1i(d.getUniformLocation(this.program,c),b),a},ad.prototype.compileShader=function(b,c){var d=this.gl,a=d.createShader(b);if(d.shaderSource(a,c),d.compileShader(a),!d.getShaderParameter(a,d.COMPILE_STATUS)){throw new Error(d.getShaderInfoLog(a))}return a},ad.prototype.initWebGL=function(){try{var a=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}catch(b){return !1}if(!a){return !1}if(this.buffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),a.STATIC_DRAW),this.program=a.createProgram(),a.attachShader(this.program,this.compileShader(a.VERTEX_SHADER,q)),a.attachShader(this.program,this.compileShader(a.FRAGMENT_SHADER,ac)),a.linkProgram(this.program),!a.getProgramParameter(this.program,a.LINK_STATUS)){throw new Error(a.getProgramInfoLog(this.program))}a.useProgram(this.program),this.YTexture=this.createTexture(0,"YTexture"),this.CBTexture=this.createTexture(1,"CBTexture"),this.CRTexture=this.createTexture(2,"CRTexture");var c=a.getAttribLocation(this.program,"vertex");return a.enableVertexAttribArray(c),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),this.loadingProgram=a.createProgram(),a.attachShader(this.loadingProgram,this.compileShader(a.VERTEX_SHADER,q)),a.attachShader(this.loadingProgram,this.compileShader(a.FRAGMENT_SHADER,B)),a.linkProgram(this.loadingProgram),a.useProgram(this.loadingProgram),c=a.getAttribLocation(this.loadingProgram,"vertex"),a.enableVertexAttribArray(c),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),!0},ad.prototype.renderFrameGL=function(){var b=this.gl,c=new Uint8Array(this.currentY.buffer),d=new Uint8Array(this.currentCr.buffer),a=new Uint8Array(this.currentCb.buffer);b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.YTexture),b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.codedWidth,this.height,0,b.LUMINANCE,b.UNSIGNED_BYTE,c),b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,this.CBTexture),b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.halfWidth,this.height/2,0,b.LUMINANCE,b.UNSIGNED_BYTE,d),b.activeTexture(b.TEXTURE2),b.bindTexture(b.TEXTURE_2D,this.CRTexture),b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.halfWidth,this.height/2,0,b.LUMINANCE,b.UNSIGNED_BYTE,a),b.drawArrays(b.TRIANGLE_STRIP,0,4)},ad.prototype.quantizerScale=0,ad.prototype.sliceBegin=!1,ad.prototype.decodeSlice=function(a){for(this.sliceBegin=!0,this.macroblockAddress=(a-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.buffer.getBits(5);this.buffer.getBits(1);){this.buffer.advance(8)}do{this.decodeMacroblock()}while(!this.buffer.nextBytesAreStartCode())},ad.prototype.macroblockAddress=0,ad.prototype.mbRow=0,ad.prototype.mbCol=0,ad.prototype.macroblockType=0,ad.prototype.macroblockIntra=!1,ad.prototype.macroblockMotFw=!1,ad.prototype.motionFwH=0,ad.prototype.motionFwV=0,ad.prototype.motionFwHPrev=0,ad.prototype.motionFwVPrev=0,ad.prototype.decodeMacroblock=function(){for(var b=0,c=this.readCode(ai);34==c;){c=this.readCode(ai)}for(;35==c;){b+=33,c=this.readCode(ai)}if(b+=c,this.sliceBegin){this.sliceBegin=!1,this.macroblockAddress+=b}else{if(this.macroblockAddress+b>=this.mbSize){return}for(b>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureCodingType==af&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));b>1;){this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),b--}this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.macroblockType=this.readCode(M[this.pictureCodingType]),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.buffer.getBits(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var d=0!=(2&this.macroblockType)?this.readCode(X):this.macroblockIntra?63:0,a=0,f=32;6>a;a++){0!=(d&f)&&this.decodeBlock(a),f>>=1}},ad.prototype.decodeMotionVectors=function(){var a,b,c=0;this.macroblockMotFw?(a=this.readCode(aa),0!=a&&1!=this.forwardF?(c=this.buffer.getBits(this.forwardRSize),b=(Math.abs(a)-1<<this.forwardRSize)+c+1,0>a&&(b=-b)):b=a,this.motionFwHPrev+=b,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),a=this.readCode(aa),0!=a&&1!=this.forwardF?(c=this.buffer.getBits(this.forwardRSize),b=(Math.abs(a)-1<<this.forwardRSize)+c+1,0>a&&(b=-b)):b=a,this.motionFwVPrev+=b,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureCodingType==af&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},ad.prototype.copyMacroblock=function(ap,at,aE,aA,aw){var aq,aI,aB,ax,aG,aF,aD,ao,az,av=this.currentY32,ay=this.currentCb32,aH=this.currentCr32;aq=this.codedWidth,aI=aq-16,aB=ap>>1,ax=at>>1,aG=1==(1&ap),aF=1==(1&at),aD=((this.mbRow<<4)+ax)*aq+(this.mbCol<<4)+aB,ao=this.mbRow*aq+this.mbCol<<2,az=ao+(aq<<2);var E,S,ar;if(aG){if(aF){for(;az>ao;){E=aE[aD]+aE[aD+aq],aD++;for(var aC=0;4>aC;aC++){S=aE[aD]+aE[aD+aq],aD++,ar=E+S+2>>2&255,E=aE[aD]+aE[aD+aq],aD++,ar|=E+S+2<<6&65280,S=aE[aD]+aE[aD+aq],aD++,ar|=E+S+2<<14&16711680,E=aE[aD]+aE[aD+aq],aD++,ar|=E+S+2<<22&4278190080,av[ao++]=ar}ao+=aI>>2,aD+=aI-1}}else{for(;az>ao;){E=aE[aD++];for(var aC=0;4>aC;aC++){S=aE[aD++],ar=E+S+1>>1&255,E=aE[aD++],ar|=E+S+1<<7&65280,S=aE[aD++],ar|=E+S+1<<15&16711680,E=aE[aD++],ar|=E+S+1<<23&4278190080,av[ao++]=ar}ao+=aI>>2,aD+=aI-1}}}else{if(aF){for(;az>ao;){for(var aC=0;4>aC;aC++){ar=aE[aD]+aE[aD+aq]+1>>1&255,aD++,ar|=aE[aD]+aE[aD+aq]+1<<7&65280,aD++,ar|=aE[aD]+aE[aD+aq]+1<<15&16711680,aD++,ar|=aE[aD]+aE[aD+aq]+1<<23&4278190080,aD++,av[ao++]=ar}ao+=aI>>2,aD+=aI}}else{for(;az>ao;){for(var aC=0;4>aC;aC++){ar=aE[aD],aD++,ar|=aE[aD]<<8,aD++,ar|=aE[aD]<<16,aD++,ar|=aE[aD]<<24,aD++,av[ao++]=ar}ao+=aI>>2,aD+=aI}}}aq=this.halfWidth,aI=aq-8,aB=ap/2>>1,ax=at/2>>1,aG=1==(ap/2&1),aF=1==(at/2&1),aD=((this.mbRow<<3)+ax)*aq+(this.mbCol<<3)+aB,ao=this.mbRow*aq+this.mbCol<<1,az=ao+(aq<<1);var k,am,an,P,au,D;if(aG){if(aF){for(;az>ao;){k=aA[aD]+aA[aD+aq],P=aw[aD]+aw[aD+aq],aD++;for(var aC=0;2>aC;aC++){am=aA[aD]+aA[aD+aq],au=aw[aD]+aw[aD+aq],aD++,an=k+am+2>>2&255,D=P+au+2>>2&255,k=aA[aD]+aA[aD+aq],P=aw[aD]+aw[aD+aq],aD++,an|=k+am+2<<6&65280,D|=P+au+2<<6&65280,am=aA[aD]+aA[aD+aq],au=aw[aD]+aw[aD+aq],aD++,an|=k+am+2<<14&16711680,D|=P+au+2<<14&16711680,k=aA[aD]+aA[aD+aq],P=aw[aD]+aw[aD+aq],aD++,an|=k+am+2<<22&4278190080,D|=P+au+2<<22&4278190080,aH[ao]=an,ay[ao]=D,ao++}ao+=aI>>2,aD+=aI-1}}else{for(;az>ao;){k=aA[aD],P=aw[aD],aD++;for(var aC=0;2>aC;aC++){am=aA[aD],au=aw[aD++],an=k+am+1>>1&255,D=P+au+1>>1&255,k=aA[aD],P=aw[aD++],an|=k+am+1<<7&65280,D|=P+au+1<<7&65280,am=aA[aD],au=aw[aD++],an|=k+am+1<<15&16711680,D|=P+au+1<<15&16711680,k=aA[aD],P=aw[aD++],an|=k+am+1<<23&4278190080,D|=P+au+1<<23&4278190080,aH[ao]=an,ay[ao]=D,ao++}ao+=aI>>2,aD+=aI-1}}}else{if(aF){for(;az>ao;){for(var aC=0;2>aC;aC++){an=aA[aD]+aA[aD+aq]+1>>1&255,D=aw[aD]+aw[aD+aq]+1>>1&255,aD++,an|=aA[aD]+aA[aD+aq]+1<<7&65280,D|=aw[aD]+aw[aD+aq]+1<<7&65280,aD++,an|=aA[aD]+aA[aD+aq]+1<<15&16711680,D|=aw[aD]+aw[aD+aq]+1<<15&16711680,aD++,an|=aA[aD]+aA[aD+aq]+1<<23&4278190080,D|=aw[aD]+aw[aD+aq]+1<<23&4278190080,aD++,aH[ao]=an,ay[ao]=D,ao++}ao+=aI>>2,aD+=aI}}else{for(;az>ao;){for(var aC=0;2>aC;aC++){an=aA[aD],D=aw[aD],aD++,an|=aA[aD]<<8,D|=aw[aD]<<8,aD++,an|=aA[aD]<<16,D|=aw[aD]<<16,aD++,an|=aA[aD]<<24,D|=aw[aD]<<24,aD++,aH[ao]=an,ay[ao]=D,ao++}ao+=aI>>2,aD+=aI}}}},ad.prototype.dcPredictorY,ad.prototype.dcPredictorCr,ad.prototype.dcPredictorCb,ad.prototype.blockData=null,ad.prototype.decodeBlock=function(C){var a,x=0;if(this.macroblockIntra){var m,c;if(4>C?(m=this.dcPredictorY,c=this.readCode(ak)):(m=4==C?this.dcPredictorCr:this.dcPredictorCb,c=this.readCode(G)),c>0){var D=this.buffer.getBits(c);this.blockData[0]=0!=(D&1<<c-1)?m+D:m+(-1<<c|D+1)}else{this.blockData[0]=m}4>C?this.dcPredictorY=this.blockData[0]:4==C?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,a=this.intraQuantMatrix,x=1}else{a=this.nonIntraQuantMatrix}for(var v=0;;){var g=0,y=this.readCode(I);if(1==y&&x>0&&0==this.buffer.getBits(1)){break}65535==y?(g=this.buffer.getBits(6),v=this.buffer.getBits(8),0==v?v=this.buffer.getBits(8):128==v?v=this.buffer.getBits(8)-256:v>128&&(v-=256)):(g=y>>8,v=255&y,this.buffer.getBits(1)&&(v=-v)),x+=g;var w=al[x];x++,v<<=1,this.macroblockIntra||(v+=0>v?-1:1),v=v*this.quantizerScale*a[w]>>4,0==(1&v)&&(v-=v>0?1:-1),v>2047?v=2047:-2048>v&&(v=-2048),this.blockData[w]=v*aj[w]}var A,k,b;4>C?(A=this.currentY,b=this.codedWidth-8,k=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&C)&&(k+=8),0!=(2&C)&&(k+=this.codedWidth<<3)):(A=4==C?this.currentCb:this.currentCr,b=(this.codedWidth>>1)-8,k=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1==x?(this.copyValueToDestination(this.blockData[0]+128>>8,A,k,b),this.blockData[0]=0):(this.IDCT(),this.copyBlockToDestination(this.blockData,A,k,b),this.blockData.set(this.zeroBlockData)):1==x?(this.addValueToDestination(this.blockData[0]+128>>8,A,k,b),this.blockData[0]=0):(this.IDCT(),this.addBlockToDestination(this.blockData,A,k,b),this.blockData.set(this.zeroBlockData)),x=0},ad.prototype.copyBlockToDestination=function(b,c,d,a){for(var f=0;64>f;f+=8,d+=a+8){c[d+0]=b[f+0],c[d+1]=b[f+1],c[d+2]=b[f+2],c[d+3]=b[f+3],c[d+4]=b[f+4],c[d+5]=b[f+5],c[d+6]=b[f+6],c[d+7]=b[f+7]}},ad.prototype.addBlockToDestination=function(b,c,d,a){for(var f=0;64>f;f+=8,d+=a+8){c[d+0]+=b[f+0],c[d+1]+=b[f+1],c[d+2]+=b[f+2],c[d+3]+=b[f+3],c[d+4]+=b[f+4],c[d+5]+=b[f+5],c[d+6]+=b[f+6],c[d+7]+=b[f+7]}},ad.prototype.copyValueToDestination=function(b,c,d,a){for(var f=0;64>f;f+=8,d+=a+8){c[d+0]=b,c[d+1]=b,c[d+2]=b,c[d+3]=b,c[d+4]=b,c[d+5]=b,c[d+6]=b,c[d+7]=b}},ad.prototype.addValueToDestination=function(b,c,d,a){for(var f=0;64>f;f+=8,d+=a+8){c[d+0]+=b,c[d+1]+=b,c[d+2]+=b,c[d+3]+=b,c[d+4]+=b,c[d+5]+=b,c[d+6]+=b,c[d+7]+=b}},ad.prototype.copyBlockToDestinationClamp=function(d,k,l,c){for(var m=0,g=0;8>g;g++){for(var b=0;8>b;b++){var f=d[m++];k[l++]=f>255?255:0>f?0:f}l+=c}},ad.prototype.addBlockToDestinationClamp=function(d,k,l,c){for(var m=0,g=0;8>g;g++){for(var b=0;8>b;b++){var f=d[m++]+k[l];k[l++]=f>255?255:0>f?0:f}l+=c}},ad.prototype.IDCT=function(){var x,E,ap,am,P,A,au,an,R,ar,aq,ao,v,T,F,S,at,g,k,D=this.blockData;for(k=0;8>k;++k){x=D[32+k],E=D[16+k]+D[48+k],ap=D[40+k]-D[24+k],A=D[8+k]+D[56+k],au=D[24+k]+D[40+k],am=D[8+k]-D[56+k],P=A+au,an=D[0+k],v=(473*am-196*ap+128>>8)-P,R=v-(362*(A-au)+128>>8),ar=an-x,aq=(362*(D[16+k]-D[48+k])+128>>8)-E,ao=an+x,T=ar+aq,F=ao+E,S=ar-aq,at=ao-E,g=-R-(473*ap+196*am+128>>8),D[0+k]=P+F,D[8+k]=v+T,D[16+k]=S-R,D[24+k]=at-g,D[32+k]=at+g,D[40+k]=R+S,D[48+k]=T-v,D[56+k]=F-P}for(k=0;64>k;k+=8){x=D[4+k],E=D[2+k]+D[6+k],ap=D[5+k]-D[3+k],A=D[1+k]+D[7+k],au=D[3+k]+D[5+k],am=D[1+k]-D[7+k],P=A+au,an=D[0+k],v=(473*am-196*ap+128>>8)-P,R=v-(362*(A-au)+128>>8),ar=an-x,aq=(362*(D[2+k]-D[6+k])+128>>8)-E,ao=an+x,T=ar+aq,F=ao+E,S=ar-aq,at=ao-E,g=-R-(473*ap+196*am+128>>8),D[0+k]=P+F+128>>8,D[1+k]=v+T+128>>8,D[2+k]=S-R+128>>8,D[3+k]=at-g+128>>8,D[4+k]=at+g+128>>8,D[5+k]=R+S+128>>8,D[6+k]=T-v+128>>8,D[7+k]=F-P+128>>8}};var Y=1,Q=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],al=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),ae=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),Z=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),aj=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),ai=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),ag=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),L=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),ab=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),X=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),aa=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),ak=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),G=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),I=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),U=1,af=2,j=3,J=179,K=1,H=175,W=0,z=181,O=178,ac=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),B=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),q=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n"),M=[null,ag,L,ab]}(window);